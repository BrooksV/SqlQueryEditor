<Window x:Class="SqlQueryEditor.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="SqlQueryEditor" Height="800" Width="1200" Topmost="False"
    ResizeMode="CanResizeWithGrip" ShowInTaskbar="True"
    WindowStartupLocation="CenterScreen"
    x:Name="MainForm"
    Background="AliceBlue" UseLayoutRounding="True">

    <Window.Resources>
        <!--
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"/>
        -->
        <!-- TreeView Brushes)
        <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#FFF3EDE0" />
        <SolidColorBrush x:Key="SolidBorderBrush" Color="#888" />
        <SolidColorBrush x:Key="GlyphBrush" Color="#444" />
         -->
        <SolidColorBrush x:Key="WindowBackgroundBrush" Color="AliceBlue" />
        <SolidColorBrush x:Key="SolidBorderBrush" Color="DarkBlue" />
        <SolidColorBrush x:Key="SolidExpanderHeaderBrush" Color="DarkGreen" />
        <SolidColorBrush x:Key="GlyphBrush" Color="#444" />

        <SolidColorBrush x:Key="TabBackgroundBrush" Color="LightSkyBlue" />
        <SolidColorBrush x:Key="HyperLinkSolidBrush" Color="DarkRed" />
        <SolidColorBrush x:Key="ButtonBackgroundBrush" Color="AliceBlue" />
        <SolidColorBrush x:Key="ButtonForegroundBrush" Color="DarkBlue" />
        <SolidColorBrush x:Key="ButtonActiveForegroundBrush" Color="DarkRed" />
        <SolidColorBrush x:Key="EditBackgroundBrush" Color="Coral" />
        <SolidColorBrush x:Key="EditErrorBackgroundBrush" Color="Coral" />
        <!-- #FFFF7F50 OldLace -->
        <SolidColorBrush x:Key="MenuActiveFontColor" Color="DarkBlue" />

        <SolidColorBrush x:Key="DataGridBackgroundBrush" Color="AliceBlue"/>
        <!-- "#FFF3EDE0" "#FFF1E6CF" -->
        <SolidColorBrush x:Key="DataGridHeaderBackgroundBrush" Color="#FFE0CCA2" />

        <LinearGradientBrush x:Key="NormalBrush" StartPoint="0,0" EndPoint="0,1">
            <GradientBrush.GradientStops>
                <GradientStopCollection>
                    <GradientStop Color="#FFFFD190" Offset="0.2"/>
                    <GradientStop Color="Orange" Offset="0.85"/>
                    <GradientStop Color="#FFFFD190" Offset="1"/>
                </GradientStopCollection>
            </GradientBrush.GradientStops>
        </LinearGradientBrush>

       <Style TargetType="{x:Type TabItem}">
            <Setter Property="FontFamily" Value="Verdana"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Grid>
                            <Border 
                            x:Name="Border"
                            BorderThickness="1,1,1,0" BorderBrush="{StaticResource SolidBorderBrush}"
                            CornerRadius="6,4,0,0"
                            Margin="0,0"
                            >
                                <ContentPresenter x:Name="ContentSite"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center"
                                ContentSource="Header"
                                Margin="10,4,10,4"
                                />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource TabBackgroundBrush}" />
                            </Trigger>

                            <Trigger Property="IsSelected" Value="False">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource ButtonBackgroundBrush}" />
                            </Trigger>
                            <Trigger Property="Border.IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="LightSteelBlue" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected" Value="True"/>
                                    <Condition Property="Border.IsMouseOver" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource TabBackgroundBrush}" />
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="styColumnHeader" TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="Background" Value="{StaticResource DataGridHeaderBackgroundBrush}" />
            <Setter Property="BorderBrush" Value="Black" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="3,1,3,1" />
        </Style>

        <Style x:Key="styDataGrid" TargetType="{x:Type DataGrid}">
            <Setter Property="ColumnHeaderStyle" Value="{DynamicResource styColumnHeader}" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Background" Value="{StaticResource DataGridBackgroundBrush}" />
            <Setter Property="BorderBrush" Value="Black" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="TextElement.Foreground" Value="Blue"/>
            <!-- Setter Property="TextElement.FocusVisualStyle" Value="{DynamicResource FocusVisualStyleDG}"/ -->
            <Setter Property="GridLinesVisibility" Value="All" />
            <Setter Property="Padding" Value="3,1,3,1" />

            <Setter Property="IsTabStop" Value="True"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="RowHeaderWidth" Value="40"/>
            <Setter Property="VerticalGridLinesBrush" Value="LightSteelBlue"/>
            <Setter Property="HorizontalGridLinesBrush" Value="LightSteelBlue"/>
            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="DataGridCell">
                        <Setter Property="BorderThickness" Value="0"/>
                        <!-- Setter Property="FocusVisualStyle" Value="{x:Null}"/ -->
                        <!-- The selected row is shown in blue even when focus has been lost -->
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="CornflowerBlue"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="{x:Type DataGridRow}">
            <Setter Property="FontSize" Value="12"/>
            <!-- Setter Property="FontFamily" Value="Arial"/ -->
            <!-- Setter Property="FontWeight" Value="Bold"/ -->
            <!-- Setter Property="Foreground" Value="White"/ -->
            <Setter Property="Background" Value="{StaticResource DataGridBackgroundBrush}"/>
            <Setter Property="FocusVisualStyle" Value="{DynamicResource FocusVisualStyleDG}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="AliceBlue" />
                </Trigger>
                <Trigger Property="IsSelected"
                            Value="True">
                    <Setter Property="BorderBrush"
                            Value="Blue" />
                    <Setter Property="BorderThickness"
                            Value="2" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="errorStyle" TargetType="{x:Type TextBox}">
            <Setter Property="Padding" Value="-2"/>
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="Background" Value="{DynamicResource EditErrorBackgroundBrush}"/>
                    <Setter Property="ToolTip" 
                    Value="{Binding RelativeSource={RelativeSource Self},
                    Path=(Validation.Errors)[0].ErrorContent}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="promptText" TargetType="{x:Type TextBlock}">
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Margin" Value="0,0,0,0"/>
            <Setter Property="Width" Value="{Binding RelativeSource={RelativeSource AncestorType=ListView},Path=ActualWidth}"/>
            <Setter Property="Padding" Value="2,2,2,2"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding XPath=@IsEditable}" Value="True">
                    <Setter Property="FontWeight" Value="Bold"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="editText" TargetType="{x:Type TextBox}">
            <Setter Property="FontFamily" Value="Verdana"/>
            <Setter Property="FontSize" Value="11px"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Width" Value="{Binding RelativeSource={RelativeSource AncestorType=ListView},Path=ActualWidth}"/>
            <Setter Property="Height" Value="Auto"/>
            <Setter Property="Background" >
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" >
                        <GradientStop Color="#FFFFD190" Offset="0.2"/>
                        <GradientStop Color="Bisque" Offset="0.85"/>
                        <GradientStop Color="#FFFFD190" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="-6,0,0,0"/>
            <Setter Property="Padding" Value="2,2,2,2"/>
            <Setter Property="IsEnabled" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding XPath=@IsEditable}" Value="True">
                    <Setter Property="IsEnabled" Value="True"/>
                </DataTrigger>

                <DataTrigger Binding="{Binding ElementName=mnuEditScript, Path=Tag}" Value="1">
                    <Setter Property="IsReadOnly" Value="False"/>
                    <Setter Property="Background" Value="{StaticResource EditBackgroundBrush}" />
                </DataTrigger>

            </Style.Triggers>
        </Style>

        <!-- ============================================================
		Button related resources, styles, templates
        ============================================================= -->
        <Style x:Key="btnStyleDefault" TargetType="{x:Type ToggleButton}" >
            <Setter Property="FontFamily" Value="Verdana"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Foreground" Value="Black" />
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" >
                        <GradientStop Color="#FFFFD190" Offset="0.2"/>
                        <GradientStop Color="Orange" Offset="0.85"/>
                        <GradientStop Color="#FFFFD190" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>                                
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Grid x:Name="btnGrid">
                            <Border BorderThickness="1"
                                    CornerRadius="2"
                                    Padding="1"
                                    x:Name="ButtonBorder"
                                    Background="{TemplateBinding Background}"
                                >
                                <Border.BorderBrush>
                                    <SolidColorBrush Color="DarkBlue"/>
                                </Border.BorderBrush>
                                <ContentPresenter VerticalAlignment="Center"
                                    Margin="2,1" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                            <GradientStop Color="#4888A6D7" Offset="0"/>
                                            <GradientStop Color="#48EBEBEB" Offset="0.5"/>
                                            <GradientStop Color="#481853B1" Offset="0.5"/>
                                            <GradientStop Color="#48779AD1" Offset="1"/>
                                            <GradientStop Color="#484977C2" Offset="0.498"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                            <GradientStop Color="#A888A6D7" Offset="0"/>
                                            <GradientStop Color="#A8EBEBEB" Offset="0.5"/>
                                            <GradientStop Color="#A81853B1" Offset="0.5"/>
                                            <GradientStop Color="#A8779AD1" Offset="1"/>
                                            <GradientStop Color="#A84977C2" Offset="0.498"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>

                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" TargetName="btnGrid" Value="0.25"/>
                            </Trigger>

                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ============================================================
		Menu related resources, styles, templates
        ============================================================= -->
        <SolidColorBrush x:Key="Menu.Static.Foreground" Color="White"/>
        <SolidColorBrush x:Key="Menu.Static.Background" Color="Black"/>
        <SolidColorBrush x:Key="Menu.Static.Border" Color="Transparent"/>

        <!-- TopLevel Menu Item Template -->
        <ControlTemplate x:Key="TopLevelMenuItemTemplate" TargetType="{x:Type MenuItem}">
            <Border x:Name="templateRoot" 
            BorderBrush="{TemplateBinding BorderBrush}" 
            BorderThickness="{TemplateBinding BorderThickness}" 
            Background="{TemplateBinding Background}" 
            SnapsToDevicePixels="True"
            >
                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ContentPresenter ContentTemplate="{TemplateBinding HeaderTemplate}" 
                    Content="{TemplateBinding Header}" Grid.Column="1" 
                    ContentStringFormat="{TemplateBinding HeaderStringFormat}" 
                    ContentSource="Header" 
                    Margin="{TemplateBinding Padding}" 
                    RecognizesAccessKey="True" 
                    HorizontalAlignment="Center"
                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                    />
                </Grid>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsHighlighted"  Value="true">
                    <Setter Property="BorderBrush" Value="Red"/>
                </Trigger>

                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#4888A6D7" Offset="0"/>
                                <GradientStop Color="#48EBEBEB" Offset="0.5"/>
                                <GradientStop Color="#481853B1" Offset="0.5"/>
                                <GradientStop Color="#48779AD1" Offset="1"/>
                                <GradientStop Color="#484977C2" Offset="0.498"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </Trigger>

                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#A888A6D7" Offset="0"/>
                                <GradientStop Color="#A8EBEBEB" Offset="0.5"/>
                                <GradientStop Color="#A81853B1" Offset="0.5"/>
                                <GradientStop Color="#A8779AD1" Offset="1"/>
                                <GradientStop Color="#A84977C2" Offset="0.498"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!-- TopLevel Menu Header (has sub menu items) Template -->
        <ControlTemplate x:Key="HeaderMenuItemTemplate" TargetType="{x:Type MenuItem}">
            <Border x:Name="templateRoot" 
            BorderBrush="{TemplateBinding BorderBrush}" 
            BorderThickness="{TemplateBinding BorderThickness}" 
            Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ContentPresenter x:Name="Icon" 
                    Content="{TemplateBinding Icon}" ContentSource="Icon" 
                    HorizontalAlignment="Center" Height="16" Margin="3" 
                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                    VerticalAlignment="Center" Width="16"/>
                    <Path x:Name="GlyphPanel" Data="F1M10,1.2L4.7,9.1 4.5,9.1 0,5.2 1.3,3.5 4.3,6.1 8.3,0 10,1.2z" 
                    Fill="{TemplateBinding Foreground}" FlowDirection="LeftToRight" Margin="3"
                    Visibility="Collapsed" VerticalAlignment="Center"/>
                    <ContentPresenter ContentTemplate="{TemplateBinding HeaderTemplate}" 
                    Content="{TemplateBinding Header}" Grid.Column="1" 
                    ContentStringFormat="{TemplateBinding HeaderStringFormat}" 
                    ContentSource="Header" Margin="{TemplateBinding Padding}"
                    RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    <Popup x:Name="PART_Popup" AllowsTransparency="True" 
                    Focusable="False" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" 
                    PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" 
                    Placement="Bottom">
                        <Border x:Name="SubMenuBorder" 
                        BorderBrush="#FF999999" BorderThickness="1" 
                        Background="#FFF0F0F0" Padding="2">
                            <ScrollViewer x:Name="SubMenuScrollViewer" 
                            Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                <Grid RenderOptions.ClearTypeHint="Enabled">
                                    <Canvas HorizontalAlignment="Left" Height="0" VerticalAlignment="Top" Width="0">
                                        <Rectangle x:Name="OpaqueRect" 
                                        Fill="{Binding Background, ElementName=SubMenuBorder}" 
                                        Height="{Binding ActualHeight, ElementName=SubMenuBorder}" 
                                        Width="{Binding ActualWidth, ElementName=SubMenuBorder}"/>
                                    </Canvas>
                                    <Rectangle Fill="#FFD7D7D7" HorizontalAlignment="Left" Margin="29,2,0,2" Width="1"/>
                                    <ItemsPresenter x:Name="ItemsPresenter" 
                                    KeyboardNavigation.DirectionalNavigation="Cycle" 
                                    Grid.IsSharedSizeScope="True" 
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                                    KeyboardNavigation.TabNavigation="Cycle"/>
                                </Grid>
                            </ScrollViewer>
                        </Border>
                    </Popup>
                </Grid>
            </Border>
            <!-- Triggers for MenuItems with SubMenus -->
            <ControlTemplate.Triggers>
                <Trigger Property="IsSuspendingPopupAnimation" Value="True">
                    <Setter Property="PopupAnimation" TargetName="PART_Popup" Value="None"/>
                </Trigger>
                <Trigger Property="Icon" Value="">
                    <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                </Trigger>
                <Trigger Property="IsChecked" Value="True">
                    <Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
                    <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                </Trigger>
                <Trigger Property="IsHighlighted" Value="True">
                    <Setter Property="Background" TargetName="templateRoot" Value="CornFlowerBlue" />
                    <Setter Property="TextElement.Foreground" TargetName="templateRoot" Value="White"/>
                    <!-- <Setter Property="BorderBrush" TargetName="templateRoot" Value="#FF26A0DA"/> -->
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="TextElement.Foreground" TargetName="templateRoot" Value="#FF707070"/>
                    <Setter Property="Fill" TargetName="GlyphPanel" Value="#FF707070"/>
                </Trigger>
                <Trigger Property="CanContentScroll" SourceName="SubMenuScrollViewer" Value="False">
                    <Setter Property="Canvas.Top" TargetName="OpaqueRect" Value="{Binding VerticalOffset, ElementName=SubMenuScrollViewer}"/>
                    <Setter Property="Canvas.Left" TargetName="OpaqueRect" Value="{Binding HorizontalOffset, ElementName=SubMenuScrollViewer}"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!-- TopLevel Menu Item Style -->
        <Style x:Key="MenuItemStyle" TargetType="{x:Type MenuItem}">
            <Setter Property="Template" Value="{DynamicResource TopLevelMenuItemTemplate}"/>
            <Setter Property="Foreground" Value="{DynamicResource MenuActiveFontColor}" />
            <Setter Property="FontFamily" Value="Verdana"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="1"/>
            <Setter Property="Padding" Value="6,3,6,3"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="DarkBlue"/>
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" >
                        <GradientStop Color="#FFFFD190" Offset="0.2"/>
                        <GradientStop Color="Orange" Offset="0.85"/>
                        <GradientStop Color="#FFFFD190" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="Goldenrod"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="menuParentStyle" TargetType="{x:Type MenuItem}" BasedOn="{StaticResource MenuItemStyle}">
        </Style>

        <!-- Sub Menu Items Template -->
        <ControlTemplate x:Key="SubMenuItemControlTemplate" TargetType="{x:Type MenuItem}">
            <Border x:Name="templateRoot" 
            BorderBrush="{TemplateBinding BorderBrush}" 
            BorderThickness="{TemplateBinding BorderThickness}" 
            Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                <Grid Margin="-1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition MinWidth="22" SharedSizeGroup="MenuItemIconColumnGroup" Width="Auto"/>
                        <ColumnDefinition Width="13"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                        <ColumnDefinition SharedSizeGroup="MenuItemIGTColumnGroup" Width="Auto"/>
                        <ColumnDefinition Width="20"/>
                    </Grid.ColumnDefinitions>
                    <ContentPresenter x:Name="Icon" Content="{TemplateBinding Icon}" ContentSource="Icon" 
                    HorizontalAlignment="Center" Height="16" Margin="3" 
                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                    VerticalAlignment="Center" Width="16"/>
                    <Border x:Name="GlyphPanel" BorderBrush="#FF26A0DA" BorderThickness="1" Background="#3D26A0DA" 
                    ClipToBounds="False" HorizontalAlignment="Center" Height="22" Margin="-1,0,0,0" 
                    Visibility="Hidden" VerticalAlignment="Center" Width="22">
                        <Path x:Name="Glyph" Data="F1M10,1.2L4.7,9.1 4.5,9.1 0,5.2 1.3,3.5 4.3,6.1 8.3,0 10,1.2z" 
                        Fill="#FF212121" FlowDirection="LeftToRight" Height="11" Width="10"/>
                    </Border>
                    <ContentPresenter x:Name="menuHeaderContainer" ContentTemplate="{TemplateBinding HeaderTemplate}" 
                    Content="{TemplateBinding Header}" Grid.Column="2" 
                    ContentStringFormat="{TemplateBinding HeaderStringFormat}" ContentSource="Header" 
                    HorizontalAlignment="Left" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" 
                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="menuGestureText" Grid.Column="4" Margin="{TemplateBinding Padding}" 
                    Opacity="0.7" Text="{TemplateBinding InputGestureText}" VerticalAlignment="Center"/>
                </Grid>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="Icon" Value="">
                    <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                </Trigger>
                <Trigger Property="IsChecked" Value="True">
                    <Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
                    <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                </Trigger>
                <Trigger Property="IsHighlighted" Value="True">
                    <Setter Property="Background" TargetName="templateRoot" Value="CornFlowerBlue"/>
                    <!-- <Setter Property="BorderBrush" TargetName="templateRoot" Value="Yellow"/> -->
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="TextElement.Foreground" TargetName="templateRoot" Value="#FF707070"/>
                    <Setter Property="Fill" TargetName="Glyph" Value="#FF707070"/>
                </Trigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsHighlighted" Value="True"/>
                        <Condition Property="IsEnabled" Value="False"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="Background"  TargetName="templateRoot" Value="#0A000000"/>
                    <Setter Property="BorderBrush" TargetName="templateRoot" Value="#21000000"/>
                </MultiTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!-- Sub Menu Items Style -->
        <Style x:Key="SubMenuItemStyle" TargetType="{x:Type MenuItem}" >
            <Setter Property="Template" Value="{DynamicResource SubMenuItemControlTemplate}"/>
            <Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="Background" Value="LightBlue"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
            <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
            <Style.Triggers>
                <Trigger Property="Role" Value="TopLevelItem">
                    <Setter Property="Template" Value="{DynamicResource {ComponentResourceKey ResourceId=TopLevelMenuItemTemplate, TypeInTargetAssembly={x:Type MenuItem}}}"/>
                    <Setter Property="Background" Value="{StaticResource Menu.Static.Background}"/>
                    <Setter Property="BorderBrush" Value="{StaticResource Menu.Static.Border}"/>
                    <Setter Property="Foreground" Value="{StaticResource Menu.Static.Foreground}"/>
                    <Setter Property="Padding" Value="6,0"/>
                </Trigger>
                <Trigger Property="Role" Value="TopLevelHeader">
                    <Setter Property="Template" Value="{DynamicResource {ComponentResourceKey ResourceId=HeaderMenuItemTemplate, TypeInTargetAssembly={x:Type MenuItem}}}"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderBrush" Value="Transparent"/>
                    <Setter Property="Foreground" Value="{StaticResource Menu.Static.Foreground}"/>
                    <Setter Property="Padding" Value="6,0"/>
                </Trigger>

                <Trigger Property="Role" Value="SubmenuHeader">
                    <Setter Property="Template" Value="{DynamicResource {ComponentResourceKey ResourceId=SubMenuItemControlTemplate, TypeInTargetAssembly={x:Type MenuItem}}}"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="true">
                    <Setter Property="Background" Value="Red" />
                </Trigger>
                <Trigger Property="IsKeyboardFocusWithin" Value="true">
                    <Setter Property="Background" Value="#0a99f3" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="menuRunScriptStyle" TargetType="{x:Type MenuItem}" BasedOn="{StaticResource MenuItemStyle}">
            <Setter Property="Template" Value="{DynamicResource {ComponentResourceKey ResourceId=TopLevelMenuItemTemplate, TypeInTargetAssembly={x:Type MenuItem}}}" />
            <Setter Property="Foreground" Value="DarkBlue" />
            <Style.Triggers>
                <Trigger Property="Tag" Value="0">
                    <Setter Property="Header" Value="Execute SQL" />
                </Trigger>
                <Trigger Property="Tag" Value="1">
                    <Setter Property="Foreground" Value="DarkGreen" />
                    <Setter Property="Header" Value="Select Script" />
                </Trigger>
                <Trigger Property="Tag" Value="2">
                    <Setter Property="Header" Value="Select Script" />
                </Trigger>
                <DataTrigger Binding="{Binding ElementName=_scriptView, Path=Text}" Value="">
                    <Setter Property="Header" Value="Select Script" />
                    <Setter Property="Foreground" Value="DarkRed" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SubMenuStyle" TargetType="{x:Type MenuItem}" BasedOn="{StaticResource MenuItemStyle}">
        </Style>

        <!-- ============================================================
		Grid related resources, styles, templates
        ============================================================= -->
        <Style x:Key="FocusVisualStyleDG" TargetType="{x:Type Control}">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle Margin="-3" StrokeThickness="1"  
                            Stroke="Red"  
                            StrokeDashArray="1 2"  
                            SnapsToDevicePixels="true"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ============================================================
            ============================================================= -->
        <HierarchicalDataTemplate x:Key="tvNodeTemplate" ItemsSource="{Binding Path=Children, Mode=TwoWay}">
            <TextBlock x:Name="tbkTvDtNode" Text="{Binding Path=Name}" />
        </HierarchicalDataTemplate>

        <!-- ============================================================
			CheckBox related resources, styles, templates
            <EventSetter Event="PreviewMouseLeftButtonDown" Handler="DataGridCell_PreviewMouseLeftButtonDown" />
            <EventSetter Event="PreviewTextInput" Handler="DataGridCell_PreviewTextInput" />
        ============================================================= -->
        <Style x:Key="OrangeCheckBox" TargetType="{x:Type CheckBox}">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="DarkBlue"/>
            <Setter Property="Background" >
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" >
                        <GradientStop Color="#FFFFD190" Offset="0.2"/>
                        <GradientStop Color="Orange" Offset="0.85"/>
                        <GradientStop Color="#FFFFD190" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type CheckBox}">
                        <BulletDecorator Background="Transparent" SnapsToDevicePixels="true">
                            <BulletDecorator.Bullet>
                                <Border BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}"
                                        BorderThickness="1" Width="12" Height="12" Margin="0,1,0,0">
                                    <Grid>
                                        <Path x:Name="TickMark" Fill="Blue" Data="M0,4 5,9 9,0 4,5" Visibility="Hidden" />
                                        <Rectangle x:Name="IndeterminateMark" Fill="Blue" HorizontalAlignment="Center" Width="7" Height="7" VerticalAlignment="Center" Visibility="Hidden" />
                                    </Grid>
                                </Border>
                            </BulletDecorator.Bullet>
                            <ContentPresenter 
                                RecognizesAccessKey="True"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Margin="{TemplateBinding Padding}" />
                        </BulletDecorator>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasContent" Value="true">
                                <Setter Property="Padding" Value="4,0,0,0"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="TickMark" Property="Visibility" Value="Visible" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="{x:Null}">
                                <Setter TargetName="IndeterminateMark" Property="Visibility" Value="Visible" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsChecked" Value="True">
                    <Setter Property="Control.Foreground" Value="Blue" />
                    <Setter Property="FontWeight" Value="Bold" />
                </Trigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="CheckBox.IsMouseOver" Value="True"></Condition>
                        <Condition Property="CheckBox.IsChecked" Value="True"></Condition>
                    </MultiTrigger.Conditions>
                    <Setter Property="Control.Foreground" Value="Red" />
                </MultiTrigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="CheckBox.IsMouseOver" Value="True"></Condition>
                        <Condition Property="CheckBox.IsChecked" Value="False"></Condition>
                    </MultiTrigger.Conditions>
                    <Setter Property="Control.Foreground" Value="Green" />
                </MultiTrigger>
            </Style.Triggers>
        </Style>

        <!-- ============================================================
            ============================================================= -->
        <Style x:Key="styTVCategories" TargetType="{x:Type TreeView}">
            <Setter Property="SnapsToDevicePixels" Value="True" />
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeView}">
                        <Border 
                            x:Name="Border" 
                            CornerRadius="1" 
                            Background="{StaticResource WindowBackgroundBrush}"
                            BorderBrush="{StaticResource SolidBorderBrush}"
                            BorderThickness="2" >
                            <ScrollViewer 
                                Focusable="False"
                                CanContentScroll="True"
                                Padding="4">
                                <ItemsPresenter/>
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ============================================================
			TreeViewItem related resources, styles, templates
Changes to TextBox is not immediately sent back to the source.
Instead, the source is updated after focus was lost on the TextBox.
Behavior is controlled by a property on the binding called UpdateSourceTrigger
Defaults to the value "Default", which basically means that the source is updated based on the property that you bind to.
As of writing, all properties except for the Text property, is updated as soon as the property changes (PropertyChanged), while the Text property is updated when focus on the destination element is lost (LostFocus).
"Default" is default value of the UpdateSourceTrigger.
The other options are PropertyChanged, LostFocus and Explicit.
Explicit, source won't be updated unless you manually do it such as when you have a Button Click event to update the source value on demand using the UpdateSource() method.
LostFocus, the default for a Text binding. It means that the source value will be updated each time the destination control loses focus.
PropertyChanged, the source value will be updated each time the bound property changes, which it does in this case as soon as the text changes with each keystroke.
https://learn.microsoft.com/en-gb/archive/blogs/vinsibal/5-random-gotchas-with-the-wpf-datagrid
 
 Tag="{Binding Path=Tag}"
        ============================================================= -->
        <Style x:Key="TreeViewItemFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border>
                            <Rectangle Margin="0,0,0,0" StrokeThickness="5" Stroke="Black" StrokeDashArray="1 2" Opacity="0" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ExpandCollapseToggleStyle" TargetType="ToggleButton">
            <Setter Property="Focusable" Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid Width="20" Height="16" Background="Transparent" SnapsToDevicePixels="True">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CheckStates">
                                    <VisualState x:Name="Checked">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Collapsed">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}" />
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Expanded">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unchecked" />
                                    <VisualState x:Name="Indeterminate" />
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Path x:Name="Collapsed"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Margin="1,1,1,1"
                                Data="M 4 0 L 8 4 L 4 8 Z">
                                <Path.Fill>
                                    <SolidColorBrush Color="{DynamicResource GlyphColor}" />
                                </Path.Fill>
                            </Path>
                            <Path x:Name="Expanded"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Margin="1,1,1,1"
                                Data="M 0 4 L 8 4 L 4 8 Z"
                                Visibility="Hidden">
                                <Path.Fill>
                                    <SolidColorBrush Color="{DynamicResource GlyphColor}" />
                                </Path.Fill>
                            </Path>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--
            <Setter Property="Tag" Value={Binding Tag, RelativeSource={RelativeSource TemplatedParent}}" />
        -->

        <Style x:Key="TreeViewItemStyle" TargetType="{x:Type TreeViewItem}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
            <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" />
            <Setter Property="Padding" Value="1,0,0,0" />
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="FocusVisualStyle" Value="{StaticResource TreeViewItemFocusVisual}" />
            <Setter Property="IsExpanded" Value="{Binding Path=IsExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <Setter Property="IsSelected" Value="{Binding Path=IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <Setter Property="Tag" Value="{Binding Path=Tag, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <Setter Property="Focusable" Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeViewItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition MinWidth="19" Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetName="Bd" Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)">
                                                <EasingColorKeyFrame KeyTime="0" Value="{StaticResource SelectedBackgroundColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unselected" />
                                    <VisualState x:Name="SelectedInactive">
                                        <Storyboard>
                                            <ColorAnimationUsingKeyFrames Storyboard.TargetName="Bd" Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)">
                                                <EasingColorKeyFrame KeyTime="0" Value="{StaticResource SelectedUnfocusedColor}" />
                                            </ColorAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="ExpansionStates">
                                    <VisualState x:Name="Expanded">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="ItemsHost">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Collapsed" />
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <ToggleButton x:Name="Expander"
                                    Style="{StaticResource ExpandCollapseToggleStyle}"
                                    ClickMode="Press"
                                    IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"/>
                            <Border x:Name="Bd"
                            Grid.Column="1"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}" SnapsToDevicePixels="True">
                                <ContentPresenter x:Name="PART_Header" ContentSource="Header" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                            </Border>
                            <ItemsPresenter x:Name="ItemsHost" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Visibility="Collapsed" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasItems" Value="false">
                                <Setter TargetName="Expander" Property="Visibility" Value="Hidden" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="HasHeader" Value="false" />
                                    <Condition Property="Width" Value="Auto" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="PART_Header" Property="MinWidth" Value="75" />
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="HasHeader" Value="false" />
                                    <Condition Property="Height" Value="Auto" />
                                </MultiTrigger.Conditions>
                                <Setter TargetName="PART_Header" Property="MinHeight" Value="19" />
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="FontWeight" Value="Bold" />
                </Trigger>
            </Style.Triggers>            
        </Style>

    </Window.Resources>
    <Grid>
        <TabControl x:Name="_tabControl" Grid.Row="0" Margin="5" Padding="0"
                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                    Background="LightGray" BorderThickness="2" BorderBrush="Gray"
                    SelectedIndex="0" IsSynchronizedWithCurrentItem="True">

            <TabItem x:Name="tbDocumentTree" Tag="0" Header="Document Management" ToolTip="Browsing, Scanning, and Managing Documents">
                <!-- Add Document Management UI components here -->
            </TabItem>
            <TabItem x:Name="tbLkUpTableEdit" Tag="1" Header="Data Grid" ToolTip="Edit Data and Lookup Tables">
                <!-- Add Data Grid UI components here -->
                <Grid x:Name="TableEditGrid">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" x:Name="_LeftColumn"/>
                        <ColumnDefinition Width="6"/>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <DockPanel Name="dpTableEdit" Grid.Row="0" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="3" VerticalAlignment="Stretch" Margin="0" Background="LightBlue"/>
                    <GridSplitter Name="gridSplitterTableEdit" ShowsPreview="True" Grid.Row="0" Grid.RowSpan="1" Grid.Column="1" Grid.ColumnSpan="1" Margin="0" Padding="0" 
                        ResizeDirection="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{StaticResource NormalBrush}" 
                        Width="6" />
                    <TextBlock Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="1" FontSize="9" Height="Auto" Text="           " FontWeight="Black" Foreground="DarkBlue" Background="#BBC5D7" Tag="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center" IsHitTestVisible="False">
                        <TextBlock.LayoutTransform>
                            <RotateTransform Angle="90" />
                        </TextBlock.LayoutTransform> 
                    </TextBlock>

                    <Grid Name="RightSideGrid" Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0" Background="PaleGoldenrod" >
                        <!-- Right of the Splitter -->
                        <DockPanel x:Name="dpRightSide" Margin="-2,-2,0,0">
                            <ScrollViewer>
                                <StackPanel>
                                    <Expander Name="expRightSide" Tag="Right Side Expander" 
                                        ExpandDirection="Down" IsExpanded="True" HorizontalAlignment="Stretch" Height="Auto" Width="Auto" 
                                        BorderThickness="1" BorderBrush="{StaticResource SolidBorderBrush}" Background="{StaticResource WindowBackgroundBrush}"
                                        Margin="5,5,5,5" Padding="2,2,2,2" 
                                        HorizontalContentAlignment="Stretch" VerticalContentAlignment="Top" 
                                        >
                                        <Expander.Header>
                                        <DockPanel VerticalAlignment="Stretch">
                                            <TextBlock Text="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type Expander}}}" VerticalAlignment="Top" Height="14" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SolidExpanderHeaderBrush}" DockPanel.Dock="Left" />
                                        </DockPanel>
                                        </Expander.Header>
                                        <StackPanel x:Name="spRightSide" Orientation="Vertical" MinHeight="25" Height="Auto" Margin="0,0,0,0" HorizontalAlignment="Stretch" >
                                            <!-- RightSide Components Go Here -->
                                            <DataGrid x:Name='_dataGrid' AutoGenerateColumns='True' />
                                        </StackPanel>
                                    </Expander>
                                </StackPanel>
                            </ScrollViewer>
                        </DockPanel>
                    </Grid>
                    <!-- **********************************************************************
                        Left of the Splitter - Controls and Layout
                    ********************************************************************** -->
                    <Expander Name="_expLeftSide" Grid.Column="0" Grid.ColumnSpan="1" Grid.Row="0" Grid.RowSpan="1"
                        ExpandDirection="Left" IsExpanded="True" HorizontalAlignment="Stretch" Height="Auto" Width="Auto" 
                        BorderThickness="1" BorderBrush="{StaticResource SolidBorderBrush}" Background="{StaticResource WindowBackgroundBrush}" 
                        Margin="5,5,5,5" Padding="0" 
                        HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" 
                        >
                        <Expander.Header>
                        <DockPanel VerticalAlignment="Stretch">
                            <TextBlock Text="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type Expander}}}" VerticalAlignment="Top" Height="14" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SolidExpanderHeaderBrush}" DockPanel.Dock="Left" />
                        </DockPanel>
                        </Expander.Header>

                        <Grid x:Name="_LeftSideGrid"  Margin="0,0,0,0"  
                                HorizontalAlignment="Stretch" MaxWidth="{Binding ElementName=MainWindow, Path=ActualWidth}" 
                                VerticalAlignment="Stretch" MaxHeight="{Binding ElementName=MainWindow, Path=ActualHeight}"
                                >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" MinWidth="300"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Menu / Options -->
                            <StackPanel x:Name="spLeftSideOptions" Margin="0,0,0,0" Grid.Row="0" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="2" 
                                HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                >
                                <GroupBox x:Name="gbxLeftSideOptions" Header="SQL Query Editor Options" 
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Top" Height="Auto" 
                                        Margin="0,0,0,0" Padding="0,0,0,0">
                                    <StackPanel x:Name="spLeftSideMenu" Margin="2" Orientation="Vertical" VerticalAlignment="Top" HorizontalAlignment="Stretch">
                                        <Menu x:Name="_LeftSideMenu" Padding="3,3,3,3" Background="#FFF3EDE0" BorderBrush="LightBlue" BorderThickness="1">
                                            <MenuItem x:Name="mnuExit2" Header="Exit" Style="{StaticResource MenuItemStyle}"/>
                                        </Menu>
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                            <!-- **********************************************************************
                            Left Side of Splitter
                            ********************************************************************** -->
                            <Border x:Name="bdrLeftSide" BorderThickness="2" BorderBrush="{StaticResource NormalBrush}" Margin="0,0,0,0" Grid.Row="1" Grid.RowSpan="2" Grid.Column="0" Grid.ColumnSpan="3" 
                                    HorizontalAlignment="Stretch" VerticalAlignment="Top"
                                    >
                                <!-- Place Components Here -->
                            </Border>
                        </Grid>
                    </Expander>
                    <!-- End of Directory Tree Grid - Left Side of Splitter -->
                </Grid>
            </TabItem>
            <TabItem x:Name="tbSelection" Tag="2" Header="SQLQuery Editor" ToolTip="Select SQL Queries to Execute, Edit, Delete, or Add to SQL Query Database">
                <Grid x:Name="_gridSqlQueryEditor">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" x:Name="_LeftColumnM"/>
                        <ColumnDefinition Width="6"/>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <!--
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="20*" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="75*" />
                    </Grid.ColumnDefinitions>
                    -->
                    <DockPanel Grid.Row="0" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="3" VerticalAlignment="Stretch" Margin="0" Background="LightBlue" Name="DockPanel1" />
                    <GridSplitter Name="gridSplitter" ShowsPreview="True" Grid.Row="0" Grid.RowSpan="1" Grid.Column="1" Grid.ColumnSpan="1" Margin="0" Padding="0" 
                        ResizeDirection="Auto" Height="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{StaticResource NormalBrush}" 
                        Width="6" />
                    <TextBlock Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="1" FontSize="9" Height="Auto" Text="           " FontWeight="Black" Foreground="DarkBlue" Background="#BBC5D7" Tag="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center" IsHitTestVisible="False">
                        <TextBlock.LayoutTransform>
                            <RotateTransform Angle="90" />
                        </TextBlock.LayoutTransform> 
                    </TextBlock>

                    <Grid Name="Grid1" Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0" Background="PaleGoldenrod" >
                        <!-- Right of the Splitter -->
                        <DockPanel x:Name="_dpSelectedComponent" Margin="-2,-2,0,0">
                            <ScrollViewer>
                                <StackPanel>
                                    <Expander Name="expSelectedPolicy" Tag="Select SQL Query" 
                                        ExpandDirection="Down" IsExpanded="True" HorizontalAlignment="Stretch" Height="Auto" Width="Auto" 
                                        BorderThickness="1" BorderBrush="{StaticResource SolidBorderBrush}" Background="{StaticResource WindowBackgroundBrush}"
                                        Margin="5,5,5,5" Padding="2,2,2,2" 
                                        HorizontalContentAlignment="Stretch" VerticalContentAlignment="Top" 
                                        >
                                        <Expander.Header>
                                        <DockPanel VerticalAlignment="Stretch">
                                            <TextBlock Text="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type Expander}}}" VerticalAlignment="Top" Height="14" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SolidExpanderHeaderBrush}" DockPanel.Dock="Left" />
                                        </DockPanel>
                                        </Expander.Header>
                                        <StackPanel x:Name="spPolDefSelected" Orientation="Vertical" MinHeight="25" Height="Auto" Margin="0,0,0,0" HorizontalAlignment="Stretch" >

                                            <!-- Master-Detail Grids -->
                                            <Grid x:Name="_gridMasterDetail" >
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>

                                                <!-- Master DataGrid Menu -->
                                                <Menu x:Name="_menuMasterDataGrid" Grid.Row="0" Margin="5">
                                                    <MenuItem x:Name="mnuMExport" Header="Export">
                                                        <MenuItem x:Name="mnuMExportCopyToClipboard" Header="Copy to Clipboard"/>
                                                        <MenuItem x:Name="mnuMExportAsCSV" Header="Export as CSV"/>
                                                        <MenuItem x:Name="mnuMExportAsExcel" Header="Export as Excel"/>
                                                        <MenuItem x:Name="mnuMImportFromExcel" Header="Import from Excel"/>
                                                    </MenuItem>
                                                    <MenuItem x:Name="mnuMAdd" Header="Add"/>
                                                    <MenuItem x:Name="mnuMCancel" Header="Cancel"/>
                                                    <MenuItem x:Name="mnuMSave" Header="Save"/>
                                                    <MenuItem x:Name="mnuMDelete" Header="Delete"/>
                                                    <MenuItem x:Name="mnuMFirst" Header="First"/>
                                                    <MenuItem x:Name="mnuMPrevious" Header="Previous"/>
                                                    <MenuItem x:Name="mnuMNext" Header="Next"/>
                                                    <MenuItem x:Name="mnuMLast" Header="Last"/>
                                                </Menu>

                                                <!-- DataGrid for Master SqlQuery records -->
                                                <ScrollViewer x:Name="_svdataGridSqlQuery" Margin="5,5,0,0" Grid.Row="1"
                                                        VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" CanContentScroll="False"
                                                        IsDeferredScrollingEnabled="True">
                                                    <DataGrid x:Name="_dataGridSqlQuery" Style="{DynamicResource ResourceKey=styDataGrid}"
                                                            ItemsSource="{Binding}" 
                                                            AutoGenerateColumns="True"
                                                            IsReadOnly="False"
                                                            CanUserAddRows="True" 
                                                            CanUserReorderColumns="True" 
                                                            CanUserResizeColumns="True"
                                                            CanUserResizeRows="True" 
                                                            CanUserSortColumns="True"
                                                            CanUserDeleteRows="True"
                                                            SelectionMode="Single"
                                                            SelectionUnit="CellOrRowHeader"
                                                            VirtualizingStackPanel.VirtualizationMode="Recycling"
                                                            VirtualizingStackPanel.IsVirtualizing="True"
                                                            VirtualizingPanel.IsVirtualizingWhenGrouping="True"
                                                            EnableRowVirtualization="True"
                                                            >
                                                        <DataGrid.CellStyle>
                                                            <Style TargetType="DataGridCell">
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsSelected"
                                                                                Value="True">
                                                                        <Setter Property="Background"
                                                                                Value="White" />
                                                                        <Setter Property="Foreground"
                                                                                Value="Black" />
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </DataGrid.CellStyle>
                                                        <DataGrid.RowDetailsTemplate>
                                                            <DataTemplate>
                                                                <Border>
                                                                    <StackPanel Orientation="Vertical">
                                                                        <TextBlock Text="{Binding Path=Key}" />
                                                                    </StackPanel>
                                                                </Border>
                                                            </DataTemplate>
                                                        </DataGrid.RowDetailsTemplate>
                                                    </DataGrid>
                                                </ScrollViewer>


                                                <!-- Detail DataGrid Menu -->
                                                <Menu x:Name="_menuDetailDataGrid" Grid.Row="2" Margin="5">
                                                    <MenuItem x:Name="mnuDAdd" Header="Add" />
                                                    <MenuItem x:Name="mnuDCancel" Header="Cancel" />
                                                    <MenuItem x:Name="mnuDSave" Header="Save" />
                                                    <MenuItem x:Name="mnuDDelete" Header="Delete" />
                                                </Menu>

                                                <!-- DataGrid for Detail SqlQueryParms records -->
                                                <DataGrid x:Name="_dataGridSqlQueryParms" Grid.Row="3" Margin="5"  Style="{DynamicResource ResourceKey=styDataGrid}"
                                                        ItemsSource="{Binding}" 
                                                        AutoGenerateColumns="True"
                                                        IsReadOnly="False"
                                                        CanUserAddRows="True" 
                                                        CanUserReorderColumns="True" 
                                                        CanUserResizeColumns="True"
                                                        CanUserResizeRows="True" 
                                                        CanUserSortColumns="True"
                                                        CanUserDeleteRows="True"
                                                        SelectionMode="Single"
                                                        SelectionUnit="CellOrRowHeader"
                                                        VirtualizingStackPanel.VirtualizationMode="Recycling"
                                                        VirtualizingStackPanel.IsVirtualizing="True"
                                                        VirtualizingPanel.IsVirtualizingWhenGrouping="True"
                                                        EnableRowVirtualization="True"
                                                        >
                                                </DataGrid>
                                            </Grid>
                                        </StackPanel>
                                    </Expander>
                                </StackPanel>
                            </ScrollViewer>
                        </DockPanel>
                    </Grid>
                    <!-- **********************************************************************
                        Left of the Splitter - Policy TreeView Control and Layout
                    ********************************************************************** -->
                    <Expander Name="_expSelectQueryGrid" Grid.Column="0" Grid.ColumnSpan="1" Grid.Row="0" Grid.RowSpan="1"
                        ExpandDirection="Left" IsExpanded="True" HorizontalAlignment="Stretch" Height="Auto" Width="Auto" 
                        BorderThickness="1" BorderBrush="{StaticResource SolidBorderBrush}" Background="{StaticResource WindowBackgroundBrush}" 
                        Margin="5,5,5,5" Padding="0" 
                        HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" 
                        >
                        <Expander.Header>
                        <DockPanel VerticalAlignment="Stretch">
                            <TextBlock Text="{Binding Tag, RelativeSource={RelativeSource AncestorType={x:Type Expander}}}" VerticalAlignment="Top" Height="14" FontSize="11" FontWeight="Bold" Foreground="{StaticResource SolidExpanderHeaderBrush}" DockPanel.Dock="Left" />
                        </DockPanel>
                        </Expander.Header>

                        <Grid x:Name="_SelectQueryGrid"  Margin="0,0,0,0"  
                                HorizontalAlignment="Stretch" MaxWidth="{Binding ElementName=MainWindow, Path=ActualWidth}" 
                                VerticalAlignment="Stretch" MaxHeight="{Binding ElementName=MainWindow, Path=ActualHeight}"
                                >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" MinWidth="300"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- ## TreeView Options and Menu ##-->
                            <StackPanel x:Name="spSelectQueryOptions" Margin="0,0,0,0" Grid.Row="0" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="2" 
                                HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                >
                                <!-- ## Menu ## -->
                                <GroupBox x:Name="gbxSelectQueryOptions" Header="SQL Query Editor Options" 
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Top" Height="Auto" 
                                        Margin="0,0,0,0" Padding="0,0,0,0">
                                    <StackPanel x:Name="spSelectQueryMenu" Margin="2" Orientation="Vertical" VerticalAlignment="Top" HorizontalAlignment="Stretch">
                                        <Menu x:Name="_mnuMain" Padding="3,3,3,3" Background="#FFF3EDE0" BorderBrush="LightBlue" BorderThickness="1">
                                            <MenuItem x:Name="mnuExit" Header="Exit" Style="{StaticResource MenuItemStyle}"/>
                                            <MenuItem Header="_File" Style="{StaticResource menuParentStyle}" ItemContainerStyle="{StaticResource SubMenuItemStyle}" Template="{DynamicResource HeaderMenuItemTemplate}">
                                                <MenuItem x:Name="mnuNew" Header="_Add New" Style="{StaticResource SubMenuStyle}"/>
                                                <MenuItem x:Name="mnuExportTree" Header="_Export Tree" Style="{StaticResource SubMenuStyle}"/>
                                                <MenuItem x:Name="mnuPrintTree" Header="_Print Tree" Style="{StaticResource SubMenuStyle}"/>
                                                <MenuItem x:Name="mnuPrint" Header="_PrintSelected" Style="{StaticResource SubMenuStyle}"/>
                                                <MenuItem x:Name="mnuQuit" Header="_Quit" Style="{StaticResource SubMenuStyle}"/>
                                            </MenuItem>
                                        </Menu>
                                        <ToggleButton x:Name="_toggleEditMode" Content="Record Edit Mode - Click for Table Mode" Margin="5,0,5,0" Height="25" Width="Auto" Style="{StaticResource btnStyleDefault}" VerticalAlignment="Top" HorizontalAlignment="Left" />
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                            <!-- **********************************************************************
                            Policy TreeView - Left Side of Splitter
                            ItemTemplate="{StaticResource tvDT}" ItemContainerStyle="{DynamicResource TreeViewItemStyle}"
                            ********************************************************************** -->
                            <Border x:Name="bdrTV" BorderThickness="2" BorderBrush="{StaticResource NormalBrush}" Margin="0,0,0,0" Grid.Row="1" Grid.RowSpan="2" Grid.Column="0" Grid.ColumnSpan="3" 
                                    HorizontalAlignment="Stretch" VerticalAlignment="Top"
                                    >
                                <TreeView x:Name="_treeViewSqlQueries" Height="Auto" Width="Auto" Padding="1,1,1,1" Margin="0,0,0,0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                                    <TreeView.ItemTemplate>
                                        <HierarchicalDataTemplate>
                                            <TextBlock>
                                                <TextBlock.Text>
                                                    <MultiBinding StringFormat="{}{0} - {1}">
                                                        <Binding Path="DataSource"/>
                                                        <Binding Path="Name"/>
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                                <TextBlock.ToolTip>
                                                    <Binding Path="Description"/>
                                                </TextBlock.ToolTip>
                                            </TextBlock>
                                        </HierarchicalDataTemplate>
                                    </TreeView.ItemTemplate>
                                </TreeView>
                            </Border>
                        </Grid>
                    </Expander>
                    <!-- End of Directory Tree Grid - Left Side of Splitter -->
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
